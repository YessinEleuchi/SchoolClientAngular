<div class="min-h-screen bg-gray-100 flex items-center justify-center p-4">
  <div class="w-full max-w-2xl bg-white rounded-2xl shadow-xl p-8">
    <h1 class="text-3xl font-bold text-gray-800 mb-6">
      {{ isEditMode ? 'Edit Student' : 'Add Student' }}
    </h1>

    <!-- Success Message -->
    <div *ngIf="successMessage" class="bg-green-100 border-l-4 border-green-500 text-green-700 p-4 mb-6 rounded-r-lg">
      {{ successMessage }}
    </div>

    <!-- Error Message -->
    <div *ngIf="errorMessage" class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6 rounded-r-lg">
      {{ errorMessage }}
    </div>

    <!-- Loading Spinner -->
    <div *ngIf="isLoading" class="flex justify-center mb-6">
      <mat-spinner></mat-spinner>
    </div>

    <!-- Student Form -->
    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="space-y-6" *ngIf="!isLoading">
      <!-- Name -->
      <div>
        <label for="name" class="block text-sm font-medium text-gray-700 mb-1">Name</label>
        <input id="name" formControlName="name" type="text" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
        <div *ngIf="form.get('name')?.touched && form.get('name')?.invalid" class="text-red-600 text-sm mt-1">
          Name is required and must be less than 255 characters.
        </div>
        <div *ngIf="fieldErrors.name" class="text-red-600 text-sm mt-1">{{ fieldErrors.name }}</div>
      </div>

      <!-- Email -->
      <div>
        <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email</label>
        <input id="email" formControlName="email" type="email" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
        <div *ngIf="form.get('email')?.touched && form.get('email')?.invalid" class="text-red-600 text-sm mt-1">
          A valid email is required.
        </div>
        <div *ngIf="fieldErrors.email" class="text-red-600 text-sm mt-1">{{ fieldErrors.email }}</div>
      </div>

      <!-- Password (only in add mode) -->
      <div *ngIf="!isEditMode">
        <label for="password" class="block text-sm font-medium text-gray-700 mb-1">Password</label>
        <input id="password" formControlName="password" type="password" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
        <div *ngIf="form.get('password')?.touched && form.get('password')?.invalid" class="text-red-600 text-sm mt-1">
          Password is required and must be at least 6 characters.
        </div>
        <div *ngIf="fieldErrors.password" class="text-red-600 text-sm mt-1">{{ fieldErrors.password }}</div>
      </div>

      <!-- Gender -->
      <div>
        <label for="gender" class="block text-sm font-medium text-gray-700 mb-1">Gender</label>
        <select id="gender" formControlName="gender" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
          <option value="" disabled>Select Gender</option>
          <option value="male">Male</option>
          <option value="female">Female</option>
        </select>
        <div *ngIf="form.get('gender')?.touched && form.get('gender')?.invalid" class="text-red-600 text-sm mt-1">
          Gender is required.
        </div>
        <div *ngIf="fieldErrors.gender" class="text-red-600 text-sm mt-1">{{ fieldErrors.gender }}</div>
      </div>

      <!-- Phone -->
      <div>
        <label for="phone" class="block text-sm font-medium text-gray-700 mb-1">Phone</label>
        <input id="phone" formControlName="phone" type="text" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
        <div *ngIf="form.get('phone')?.touched && form.get('phone')?.invalid" class="text-red-600 text-sm mt-1">
          Phone is required and must be less than 20 characters.
        </div>
        <div *ngIf="fieldErrors.phone" class="text-red-600 text-sm mt-1">{{ fieldErrors.phone }}</div>
      </div>

      <!-- Address -->
      <div>
        <label for="address" class="block text-sm font-medium text-gray-700 mb-1">Address</label>
        <input id="address" formControlName="address" type="text" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
        <div *ngIf="form.get('address')?.touched && form.get('address')?.invalid" class="text-red-600 text-sm mt-1">
          Address is required and must be less than 255 characters.
        </div>
        <div *ngIf="fieldErrors.address" class="text-red-600 text-sm mt-1">{{ fieldErrors.address }}</div>
      </div>

      <!-- Date of Birth -->
      <div>
        <label for="dateofbirth" class="block text-sm font-medium text-gray-700 mb-1">Date of Birth</label>
        <input id="dateofbirth" formControlName="dateofbirth" type="date" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
        <div *ngIf="form.get('dateofbirth')?.touched && form.get('dateofbirth')?.invalid" class="text-red-600 text-sm mt-1">
          Date of Birth is required.
        </div>
        <div *ngIf="fieldErrors.dateofbirth" class="text-red-600 text-sm mt-1">{{ fieldErrors.dateofbirth }}</div>
      </div>

      <!-- Admission Number -->
      <div>
        <label for="admission_no" class="block text-sm font-medium text-gray-700 mb-1">Admission Number</label>
        <input id="admission_no" formControlName="admission_no" type="text" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
        <div *ngIf="form.get('admission_no')?.touched && form.get('admission_no')?.invalid" class="text-red-600 text-sm mt-1">
          Admission Number is required and must be less than 50 characters.
        </div>
        <div *ngIf="fieldErrors.admission_no" class="text-red-600 text-sm mt-1">{{ fieldErrors.admission_no }}</div>
      </div>

      <!-- Status -->
      <div>
        <label for="status" class="block text-sm font-medium text-gray-700 mb-1">Status</label>
        <select id="status" formControlName="status" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
          <option value="" disabled>Select Status</option>
          <option *ngFor="let status of statuses" [value]="status">{{ status }}</option>
        </select>
        <div *ngIf="form.get('status')?.touched && form.get('status')?.invalid" class="text-red-600 text-sm mt-1">
          Status is required.
        </div>
        <div *ngIf="fieldErrors.status" class="text-red-600 text-sm mt-1">{{ fieldErrors.status }}</div>
      </div>

      <!-- Group -->
      <div>
        <label for="group_id" class="block text-sm font-medium text-gray-700 mb-1">Group</label>
        <select id="group_id" formControlName="group_id" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
          <option value="" disabled>Select Group</option>
          <option *ngFor="let group of groups" [value]="group.id">{{ group.name }}</option>
        </select>
        <div *ngIf="form.get('group_id')?.touched && form.get('group_id')?.invalid" class="text-red-600 text-sm mt-1">
          Group is required.
        </div>
        <div *ngIf="fieldErrors.group_id" class="text-red-600 text-sm mt-1">{{ fieldErrors.group_id }}</div>
      </div>

      <!-- Parent -->
      <div>
        <label for="parent_id" class="block text-sm font-medium text-gray-700 mb-1">Parent (Optional)</label>
        <select id="parent_id" formControlName="parent_id" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
          <option value="">Select Parent (Optional)</option>
          <option *ngFor="let parent of parents" [value]="parent.id">{{ parent.user.name }}</option>
        </select>
        <div *ngIf="fieldErrors.parent_id" class="text-red-600 text-sm mt-1">{{ fieldErrors.parent_id }}</div>
      </div>

      <!-- Buttons -->
      <div class="flex space-x-4 mt-8">
        <button type="submit" [disabled]="isLoading || form.invalid" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200 disabled:bg-blue-300">
          {{ isLoading ? 'Saving...' : (isEditMode ? 'Update' : 'Add') }}
        </button>
        <button type="button" [disabled]="isLoading" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200 disabled:bg-gray-300" (click)="cancel()">
          Cancel
        </button>
      </div>
    </form>
  </div>
</div>